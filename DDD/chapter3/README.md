# ✍ 애그리거트

## 애그리거트

애그리거트는 관련 객체를 하나의 군으로 묶는 것을 의미한다.

> ### 애그리거트 왜 필요한가?
>
> - 도메인 객체 모델이 복잡해질수록 전반적인 구조나 큰 수준에서 도메인 간의 관계를 파악하기 어려워진다. 이는 코드를 변경하고 확장하는 것이 어려워진다는 것을 의미한다.
> - 복잡한 도메인을 이해하고 관리하기 쉬운 단위로 만들려면 상위 수준에서 모델을 조망할 수 있는 방법이 필요하다.

애그리거트는 모델을 일관성있게 관리하는 기준이다.

- 모델을 이해하는데 도움을 준다.
- 일관성을 가지고 복잡한 도메인을 단순한 구조로 만든다.
- 이는 기능을 확장과 변경하는데 필요한 노력을 줄인다.

### 애그리거트의 특징

- 독립된 객체 군이다.
  - 자신을 관리할 뿐 다른 애그리거트를 관리하지 않는다.
  - 애그리거트는 최대한 서로 독립적이여야 한다.
  - 하나의 애그리거트가 다른 애그리거트에 의존하기 시작하면 애그리거트 간 결합도가 높아진다. 결합도가 높아지면 높아질 수록 수정 비용이 증가하고, 트랜잭션 충돌이 발생할 가능성이 높아진다.
- 애그리거트에 속한 모든 객체는 일관된 상태를 유지해야한다.
  - 일관된 상태를 책임지는 것은 애그리거트의 루트 엔티티이다.
  - 루트 엔티티는 애그리거트가 제공해야할 도메인 기능을 구현한다.
  - 동시에 애그리거트에 속한 객체의 일관성이 깨지지 않도록 구현해야한다.
- 애그리거트 외부에서 애그리거트에 속한 객체를 직접 변경해선 안된다.
  - 이것은 애그리거트 루트가 강제하는 규칙을 적용할 수 없어 모델의 일관성을 깨는 원인이 된다.
  - 항상 애그리거트 루트를 통해서만 도메인 로직을 구현해야한다.
  - 이를 위해 애그리거트를 구성하는 객체들은 set 메서드를 공개 범위로 만들지 않는다.
  - 밸류타입은 불변으로 구현한다.
