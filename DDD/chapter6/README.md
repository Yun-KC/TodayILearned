## 표현 영역과 응용 영역

---

- ### 표현 영역의 역할

  1. 사용자의 요청을 해석한다.
     - URL, 요청 파라미터, 쿠키, 헤더 등을 이용해서 사용자가 실행하고 싶은 기능을 판별하고, 그 기능을 제공하는 응용 서비스를 실행한다.
  2. 응용 서비스가 요구하는 형식으로 사용자 요청을 변환한다.
     - 응용 서비스의 메서드가 요구하는 파라미터와 표현 영역이 사용자로부터 전달받은 데이터는 형식이 일치하지 않기 때문이다.
  3. 응용 서비스를 실행한 뒤 실행 결과를 사용자에게 알맞은 형식으로 응답한다.
  4. 사용자의 세션을 관리한다.

---

- ### 응용 영역의 역할

  1. 사용자가 원하는 기능을 제공한다.
     - 사용자가 요청한 기능을 처리하기 위해 리포지터리에서 도메인 객체를 가져와 사용한다.
     - 도메인 로직을 직접 구현하지 않는다. 왜?
       - 코드 응집성이 떨어진다. 도메인 데이터와 그 데이터를 조작하는 도메인 로직이 한 영역에 위치하지 않고 서로 다른 영역에 위치한다는 것은 도메인 로직을 파악하기 위해 여러 영역을 분석해야 한다는 것을 의미한다.
       - 여러 응용 서비스에서 동일한 도메인 로직을 중복 구현할 가능성이 높아진다.
       - 결과적으로 코드 변경을 어렵게 만든다. 소프트웨어의 가치를 높이려면 코드 중복을 줄이고 응집도를 높여야 한다.
  2. 트랜잭션 처리를 담당한다.
  3. 사용자와의 상호작용하지 않는다.
     - 단지 기능 실행에 필요한 입력 값을 받고 실행 결과만 리턴한다.

---

- ### **응용 서비스의 구현**

  - _응용 서비스는 표현 영역과 도메인 영역을 연결하는 매개체 역할을 한다._
    - 이는 디자인 패턴의 퍼사드와 같은 역할을 한다.
    - > 퍼사드 패턴이란?  
      > 퍼사드 패턴(Facade Pattern)은 구조 패턴(Structural Pattern)의 한 종류로, 서브시스템들의 공통적인 기능을 정의하는 단순화된 상위 수준의 인터페이스를 정의하는 패턴이다. 서브시스템들 사이의 종속성을 줄일 수 있다.
  - _응용 서비스의 크기_

    - 한 응용 서비스 클래스에 한 도메인의 모든 기능 구현하기
      1. 중복 로직을 쉽게 제거할 수 있다.
      2. 한 서비스의 클래스의 크기가 커진다.
         - 이는 연관성이 적은 코드가 한 클래스에 함께 위치해 코드를 이해하는 데 방해가 된다.
    - 구분되는 기능별로 응용 서비스 클래스를 따로 구현하기
      1. 클래스 개수는 많아지지만 코드 품질을 일정 수준으로 유지하는 데 도움이 된다.
      2. 각 기능마다 동일한 로직을 구현할 경우에도 별도 클래스에 로직을 구현해서 코드가 중복되는 것을 방지할 수 있다.
      3. 책 저자는 구분되는 기능을 별도의 서비스 클래스로 구현하는 방식을 선호한단다.

  - _응용 서비스의 인터페이스와 클래스_
    - 응용 서비스를 구현할 때 인터페이스가 필요할까?
      - 구현 클래스가 여러 개인 경우에 구현 클래스가 다수 존재하거나 런타임에 구현 객체를 교체해야할 때다.
      - 하지만 응용 서비스는 런타임에 교체하는 경우가 거의 없고, 한 응용 서비스의 구현 클래스가 두 개인 경우도 드물다.
      - 이런 이유로 인터페이스와 클래스를 따로 구현하면 소스 파일만 많아지고 구현 클래스에 대한 간접 참조가 증가해서 전체 구조가 복잡해진다.
      - 인터페이스가 명확하게 필요하기 전까지 응용 서비스에 대한 인터페이스를 작성하는 것이 좋은 선택이라 볼 수는 없다.
  - _표현 영역에 의존하지 않기_
    - 응용 서비스의 파라미터 타입을 결정할 때 표현 영역과 관련된 타입을 사용하면 안 된다.
    - 응용 서비스에서 표현 영역에 대한 의존이 발생하면 응용 서비스만 단독으로 테스트하기 어려워진다.
  - _트랜잭션 처리_

---

- ### 값 검증
  - 표현 영역: 필수 값, 값의 형식, 범위 등을 검증한다.
  - 응용 서비스: 데이터의 존재 유무와 같은 논리적 오류를 검증한다.
    - 응용 서비스에서도 필수 값을 검증해서 응용 서비스의 완성도를 높일 수도 있다.
