# **스코프**
> ### **스코프란?**
> 모든 식별자(변수 이름, 함수 이름, 클래스 이름 등)는 자신이 선언된 위치에 의해 다른 코드가 식별자 자신을 참조할 수 있는 유효 범위가 결정됩니다. 이를 스코프라 합니다.

```javascript
var x = 'global'; // 어디서든 참조 가능 = 전역 변수
function foo() {
  var x = 'local'; // foo함수 내부에서만 참조 가능 = 지역 변수
  console.log(x);
}
foo(); // local
console.log(x); // global
```
x는 이름이 동일한 식별자지만 스코프(유효 범위)가 다른 별개의 변수입니다.
프로그래밍 언어에서는 스코프(유효 범위)를 통해 식별자인 변수 이름의 충돌을 방지하여 같은 이름의 변수를 사용할 수 있게 합니다. **스코프 내에서 식별자는 유일해야 하지만 다른 스코프에는 같은 이름의 식별자를 사용할 수 있습니다. 즉 스코프는 네임스페이스입니다.**

---

## **스코프의 종류**
|구분|설명|스코프|변수|
|---|---|---|---|
|전역|코드의 가장 바깥 영역|전역 스코프|전역 변수|
|지역|함수 몸체 내부| 지역 스코프| 지역 변수|

변수는 자신이 선언된 위치에 의해 자신이 유효한 범위인 **스코프**가 결정됩니다.
전역에서 선언된 변수는 **전역 변수**, 지역(함수 내부, 블록문 내부)에서 선언된 변수는 **지역 변수**입니다.

### **전역 변수**
전역이란 코드의 가장 바깥 영역을 말합니다. 전역에 변수를 선언하면 전역 스코프를 갖는 **전역 변수**가 됩니다.
**전역 변수는 어디서든 참조할 수 있습니다.**


### **지역 변수**
지역이란 함수 몸체 내부를 말합니다. 지역에 변수를 선언하면 지역 스코프를 갖는 **지역 변수**가 됩니다.
**지역 변수는 자신의 지역 스코프와 하위 지역 스코프에서 유효합니다.**

---

## **스코프 체인**
>스코프는 함수의 중첩에 의해 계층적 구조를 갖습니다. 모든 스코프는 하나의 계층적 구조로 연결되며, 모든 지역 스코프의 최상위 스코프는전역 스코프입니다. 이렇게 계층적으로 연결된 것을 **스코프 체인<sup>scope chain</sup>** 이라 합니다.

자바스크립트는 변수를 참조할 때 스코프 체인을 통해 변수를 참조하는 코드의 스코프에서 시작하여 **상위 스코프 방향**으로 이동하며 선언된 변수를 검색합니다.    
***상위 스코프에서 유효한 변수는 하위 스코프에서 자유롭게 참조할 수 있지만 하위 스코프에서 유효한 변수를 상위 스코프에서는 참조할 수 없습니다. 스코프 체인은 단방향입니다.***
```javascript
// 전역 스코프 #1
var x = 'global x';

function outer() {
  // outer 지역 스코프 #2

  function inner() {
    // inner 지역 스코프 #3
    var y = 'inner y'
    console.log(x); // global x
  }
  inner();
}
outer();

console.log(y) // 참조 에러 발생.
```

1. #3 에서 변수 x를 잠조합니다.
2. #3 는 변수 x를 선언하지 않았기 때문에 **상위 스코프**인 #2로 이동해 변수 x를 검색합니다.
3. #2 또한 변수 x를 선언하지 않았기 때문에 #1 로 이동해 변수 x를 검색합니다.
4. 1# 스코프에서 변수 x를 참조합니다.

---

## 렉시컬 스코프

``` javascript
var x = 1;
function foo(){
  var x = 10;
  bar();
}
function bar() {
  console.log(x);
}
foo(); // ???
```
### **🤔? foo()의 실행 결과는?**
foo()의 실행결과는 bar 함수의 상위 스코프가 무엇인지에 따라 결정됩니다.   

>1️⃣ 함수를 어디서 **호출**했는지에 따라 함수의 상위 스코프를 결정한다.   
>2️⃣ 함수를 어디서 **정의**했는지에 따라 함수의 상위 스코프를 결정한다.

1️⃣의 방식일 경우 bar 함수의 상위 스코프는 foo 함수의 지역 스코프와 전역 스코프입니다. 함수가 호출되는 시점에 동적으로 상위 스코프를 결정하는 방식을 **동적 스코프**라 합니다.   
2️⃣의 방식일 경우 bar 함수의 상위 스코프는 전역 스코프입니다. 함수가 정의가 평가되는 시점에정적으로 상위 스코프를 결정하는 방식을 **정적 스코프** 또는 **렉시컬 스코프**라 합니다.

***자바스크립트는 렉시컬 스코프를 따릅니다. 함수가 정의된 위치가 상위 스코프를 결정합니다.***

🤓 foo()의 실행결과는 bar의 상위 스코프는 전역 스코프입니다.
그래서 전역 스코프에 선언되어있는 var x = 1; 을 참조하고 1을 출력합니다.
